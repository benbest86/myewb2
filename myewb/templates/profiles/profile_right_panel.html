{% comment %}
This file is part of myEWB
Copyright 2009 Engineers Without Borders (Canada) Organisation and/or volunteer contributors
{% endcomment %}

{% load i18n %}
{% load avatar_tags %}
{% load profile_tags %}

{# should probably pull this CSS stuff out into the css file... #}
<div style="padding-bottom: 15px;">
	<h2 style="margin-bottom: 0px; padding-bottom: 0px;">{% trans "Find other people" %}</h2>
	{% show_profile_search "" %}
</div>

{% if is_me %}
	<div class="membership">
		<a href="{% url profile_pay_membership other_user %}">Pay my membership fee</a>
		<br/><br/>
	</div>

	<div class="groups">
        <h2>{% trans "Your Groups" %}</h2>
        {% if other_user.basegroup_set.all %}
			<ul>
            {% for group in other_user.basegroup_set.all %}
                <li><a href="{% url group_detail group.slug %}">{{ group.name }}</a></li>
            {% endfor %}
			</ul>
        {% else %}
			{% url groups_index as groups_url %}
            <p>{% blocktrans %}You are not yet a member of any <a href="{{ groups_url }}">groups</a>.{% endblocktrans %}</p>
        {% endif %}
    </div>
    <div class="friends">
        <h2>{% trans "Your Friends" %}</h2>
        {% if other_friends %}
            <table width="100%">
                {% for friendship in other_friends %}
                {% if forloop.counter0|divisibleby:"3" %}<tr>{% endif %}
                    <td>
                        <div class="avatar">{% avatar friendship.friend 40 %}</div>
                        <div class="details"><a href="{% url profile_detail friendship.friend.username %}" title="{{ friendship.friend.username }}">{{ friendship.friend.username }}</a></div>
                    </td>
                {% if forloop.counter0|add:"1"|divisibleby:"3" %}</tr>{% endif %}
                {% endfor %}
                {% if other_friends|length|divisibleby:"3" %}{% else %}</tr>{% endif %}
            </table>
        {% else %}
            <p>{% blocktrans %}None. You should look at the list of <a href="/profiles/">profiles</a> and see if there's anyone you know.{% endblocktrans %}</p>
        {% endif %}
    </div>
{% else %}
	{# TODO: is chapter exec?? #}
	{% if user.is_staff %}
		<div class="membership">
			<a href="{% url profile_pay_membership other_user %}">Make regular member</a><br/>
			(only click if they have paid their fee in cash)
			<br/><br/>
		</div>
	{% endif %}

	{% if is_friend or user.is_staff %}
		<div class="groups">
	        <h2>{% blocktrans %}{{ other_user }}'s Groups{% endblocktrans %}</h2>
	        {% if other_user.basegroup_set.all %}
				<ul>
	            {% for group in other_user.basegroup_set.all %}
	                <li><a href="{% url group_detail group.slug %}">{{ group.name }}</a></li>
	            {% endfor %}
				</ul>
	        {% else %}
	            <p>{% blocktrans %}Not yet a member of any groups.{% endblocktrans %}</p>
	        {% endif %}
	    </div>
	    <div class="friends">
	        <h2>{% blocktrans %}{{ other_user }}'s Friends{% endblocktrans %}</h2>
	        <table width="100%">
	            {% for friendship in other_friends %}
	                {% if forloop.counter0|divisibleby:"3" %}<tr>{% endif %}
	                <td>
	                    <div class="avatar">{% avatar friendship.friend 40 %}</div>
	                    <div class="details"><a href="{% url profile_detail friendship.friend.username %}" title="{{ friendship.friend.username }}">{{ friendship.friend.username }}</a></div>
	                </td>
	                {% if forloop.counter0|add:"1"|divisibleby:"3" %}</tr>{% endif %}
	            {% endfor %}
	        {% if other_friends|length|divisibleby:"3" %}{% else %}</tr>{% endif %}
	        </table>
	    </div>
	{% endif %}
{% endif %}
